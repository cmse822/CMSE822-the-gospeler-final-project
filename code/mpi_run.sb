#!/bin/bash

#SBATCH --tasks-per-node=5
#SBATCH --nodes=5
#SBATCH --time=08:30:00
#SBATCH --mem-per-cpu=5GB
#SBATCH --constraint=amr


# load the Eigen library
module load Eigen/3.3.4

# Compile Program
mpicxx -fopenmp -o admm_lasso_mpi_n3 admm_parallel_mpi.cpp

# Variate the node sizes for each run
NODE_SIZE=(5 10 15)

# Execute multiple runs
for nSIZE in "${NODE_SIZE[@]}"; do
    mpiexec -np "$nSIZE" ./admm_lasso_mpi_n3 1500 5000 100 "mpi_run_5n_$nSIZE.csv"
done

rm admm_lasso_mpi_n3